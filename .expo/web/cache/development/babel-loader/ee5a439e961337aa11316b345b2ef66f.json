{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"/Users/verycool/Desktop/reactNative/geohut_sport/components/Home.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from \"react\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport Animated from \"react-native-web/dist/exports/Animated\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport { Button } from \"native-base\";\nimport * as Font from 'expo-font';\nimport * as firebase from \"firebase\";\nimport { Entypo } from \"@expo/vector-icons\";\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\nimport * as Permissions from \"expo-permissions\";\nimport * as Location from \"expo-location\";\nimport { getDistance } from \"geolib\";\nimport * as Animatable from \"react-native-animatable\";\nimport background from \"../assets/background.png\";\nimport PageTemplate from \"./subComponents/Header\";\nimport { connect } from \"react-redux\";\nimport PlaygroundModal from \"./subComponents/playgroundModal\";\nimport { configureBgTasks } from \"./bg\";\nvar TASK_FETCH_LOCATION = 'TASK_FETCH_LOCATION';\n\nvar moment = require(\"moment\");\n\nvar x = 'https://volleybuddy.metis-data.site';\n\nvar Home = function (_Component) {\n  _inherits(Home, _Component);\n\n  var _super = _createSuper(Home);\n\n  function Home() {\n    var _this;\n\n    _classCallCheck(this, Home);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.uid = firebase.auth().currentUser.uid;\n    _this.state = {\n      submitted: false,\n      preSubmitted: false,\n      proximity: null,\n      hasLocationPermission: null,\n      proximityMax: 200,\n      siteLocation: {\n        latitude: null,\n        longitude: null\n      },\n      submittedAnimation: false,\n      animatedValue: new Animated.Value(70),\n      volleyballCourt: {\n        latitude: 40.705030,\n        longitude: -74.011550\n      }\n    };\n\n    _this.startGeofence = function _callee() {\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              console.log('starting geofencing test ...');\n              Location.startGeofencingAsync('TASK_CHECK_GEOFENCE', [{\n                identifier: 'court',\n                latitude: _this.state.volleyballCourt.latitude,\n                longitude: _this.state.volleyballCourt.longitude,\n                radius: 150,\n                notifyOnEnter: true,\n                notifyOnExit: true\n              }]);\n\n            case 2:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.startBackgroundUpdate = function _callee2() {\n      return _regeneratorRuntime.async(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              Location.startLocationUpdatesAsync(TASK_FETCH_LOCATION, {\n                accuracy: Location.Accuracy.Highest,\n                distanceInterval: 1,\n                deferredUpdatesInterval: 1000,\n                foregroundService: {\n                  notificationTitle: 'Using your location',\n                  notificationBody: 'To turn off, go back to the app and switch something off.'\n                }\n              });\n\n            case 1:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.checkedIn = function () {\n      console.log('smth');\n      firebase.database().ref('UsersList/' + _this.uid + '/info').once('value', function (snapshot) {\n        var data = snapshot.val();\n        fetch(x + \"/checkincheck/\" + data.email).then(function (res) {\n          return res.json();\n        }).then(function (res) {\n          if (res[\"data\"].some(function (e) {\n            return e.checkin_datetime.substr(0, 10) === moment().utcOffset(\"-0500\").format(\"YYYY-MM-DD\");\n          }) && res[\"data\"].some(function (e) {\n            return e.site_id === _this.props.reducer.playgroundId;\n          })) {\n            _this.setState({\n              submitted: true\n            });\n\n            console.log('checkedIN');\n          } else {\n            _this.setState({\n              submitted: false\n            });\n          }\n        }).catch(function (error) {\n          console.log(error);\n        });\n      });\n    };\n\n    _this.readFireBase = function () {\n      firebase.database().ref('UsersList/' + _this.uid + '/info').once('value', function (snapshot) {\n        var data = snapshot.val();\n\n        _this.props.setUserData({\n          firstName: data.firstName,\n          lastName: data.lastName,\n          user_id: data.email\n        });\n      });\n    };\n\n    _this.getLocationsPermissions = function _callee3() {\n      var status;\n      return _regeneratorRuntime.async(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return _regeneratorRuntime.awrap(Permissions.getAsync(Permissions.LOCATION));\n\n            case 2:\n              status = _context3.sent;\n\n              if (!(status.status !== \"granted\")) {\n                _context3.next = 7;\n                break;\n              }\n\n              _context3.next = 6;\n              return _regeneratorRuntime.awrap(Permissions.askAsync(Permissions.LOCATION));\n\n            case 6:\n              status = _context3.sent;\n\n            case 7:\n              ;\n\n              if (status.status !== \"granted\") {\n                _this.setState({\n                  errorMessage: \"Permission to access location was denied\"\n                });\n              } else {\n                _this.setState({\n                  hasLocationPermission: status\n                });\n              }\n\n            case 9:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.logout = function () {\n      firebase.auth().signOut().catch(function (error) {\n        return console.log(error);\n      });\n\n      _this.props.navigation.navigate(\"StartScreen\");\n    };\n\n    _this.getCurrentLoc = function _callee4() {\n      var location;\n      return _regeneratorRuntime.async(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.prev = 0;\n              _context4.next = 3;\n              return _regeneratorRuntime.awrap(Location.getCurrentPositionAsync({}));\n\n            case 3:\n              location = _context4.sent;\n              _context4.next = 6;\n              return _regeneratorRuntime.awrap(JSON.stringify(location));\n\n            case 6:\n              location = _context4.sent;\n              _context4.next = 9;\n              return _regeneratorRuntime.awrap(eval(\"(\" + \"[\" + location + \"]\" + \")\"));\n\n            case 9:\n              location = _context4.sent;\n              return _context4.abrupt(\"return\", location);\n\n            case 13:\n              _context4.prev = 13;\n              _context4.t0 = _context4[\"catch\"](0);\n              Alert.alert(\"cannot get current location, try again or ask for help\");\n\n            case 16:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, null, null, [[0, 13]], Promise);\n    };\n\n    _this.calculateDistance = function _callee5(start_x, start_y, end_x, end_y) {\n      var distance;\n      return _regeneratorRuntime.async(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              _context5.prev = 0;\n              _context5.next = 3;\n              return _regeneratorRuntime.awrap(getDistance({\n                latitude: start_x,\n                longitude: start_y\n              }, {\n                latitude: end_x,\n                longitude: end_y\n              }, accuracy = 100));\n\n            case 3:\n              distance = _context5.sent;\n              console.log('test');\n              return _context5.abrupt(\"return\", distance);\n\n            case 8:\n              _context5.prev = 8;\n              _context5.t0 = _context5[\"catch\"](0);\n              alert('Something went wrong, please logout, log back in and try again');\n\n            case 11:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, null, null, [[0, 8]], Promise);\n    };\n\n    _this.handleButton = function _callee6() {\n      var location, distance;\n      return _regeneratorRuntime.async(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              if (!(_this.props.reducer.playgroundId === '')) {\n                _context6.next = 4;\n                break;\n              }\n\n              Alert.alert(\"Select your playground first.\");\n              _context6.next = 42;\n              break;\n\n            case 4:\n              if (!(_this.state.submitted === false)) {\n                _context6.next = 27;\n                break;\n              }\n\n              _this.setState({\n                submittedAnimation: true\n              });\n\n              _context6.prev = 6;\n              _context6.next = 9;\n              return _regeneratorRuntime.awrap(_this.getCurrentLoc());\n\n            case 9:\n              location = _context6.sent;\n              console.log(parseFloat(location[0].coords.latitude));\n              console.log(parseFloat(location[0].coords.longitude));\n              console.log(_this.props.reducer.playgroundLat);\n              console.log(_this.props.reducer.playgroundLon);\n              _context6.next = 16;\n              return _regeneratorRuntime.awrap(_this.calculateDistance(parseFloat(location[0].coords.latitude), parseFloat(location[0].coords.longitude), _this.props.reducer.playgroundLat, _this.props.reducer.playgroundLon));\n\n            case 16:\n              distance = _context6.sent;\n              console.log(\"distance: \", distance);\n\n              if (distance <= _this.state.proximityMax) {\n                fetch(x + \"/add?time=\" + (moment().utcOffset(\"-0500\").format(\"YYYY-MM-DD HH:mm:ss\").substr(0, 18) + \"0\") + \"&site_id=\" + _this.props.reducer.playgroundId + \"&first_name=\" + _this.props.reducer.userInfo.firstName + \"\\n            &last_name=\" + _this.props.reducer.userInfo.lastName + \"&user_id=\" + _this.props.reducer.userInfo.user_id, {\n                  method: \"POST\"\n                }).catch(function (error) {\n                  console.log(error);\n                });\n\n                _this.setState({\n                  submitted: true\n                });\n              } else {\n                Alert.alert(\"Please move closer to your site and try again.\");\n              }\n\n              _context6.next = 24;\n              break;\n\n            case 21:\n              _context6.prev = 21;\n              _context6.t0 = _context6[\"catch\"](6);\n              console.log(_context6.t0);\n\n            case 24:\n              _this.setState({\n                submittedAnimation: false\n              });\n\n              _context6.next = 42;\n              break;\n\n            case 27:\n              console.log(_this.props.reducer.playgroundId);\n              _context6.t1 = _regeneratorRuntime;\n              _context6.t3 = fetch(x + \"/update?site_id=\" + _this.props.reducer.playgroundId + \"&user_id=\" + _this.props.reducer.userInfo.user_id, {\n                method: \"PUT\"\n              }).catch(function (error) {\n                console.log(error);\n              });\n              _context6.next = 32;\n              return _regeneratorRuntime.awrap(fetch(x + \"/addToStorage?site_id=\" + _this.props.reducer.playgroundId + \"&user_id=\" + _this.props.reducer.userInfo.user_id, {\n                method: \"POST\"\n              }).catch(function (error) {\n                console.log(error);\n              }));\n\n            case 32:\n              _context6.t4 = _context6.sent;\n              _context6.t2 = _context6.t3.then.call(_context6.t3, _context6.t4);\n              _context6.next = 36;\n              return _regeneratorRuntime.awrap(fetch(x + \"/delete?site_id=\" + _this.props.reducer.playgroundId + \"&user_id=\" + _this.props.reducer.userInfo.user_id, {\n                method: \"DELETE\"\n              }).catch(function (error) {\n                console.log(error);\n              }));\n\n            case 36:\n              _context6.t5 = _context6.sent;\n              _context6.t6 = _context6.t2.then.call(_context6.t2, _context6.t5).then(_this.setState({\n                submitted: false\n              }), Alert.alert(\"You left. Good bye.\"));\n              _context6.next = 40;\n              return _context6.t1.awrap.call(_context6.t1, _context6.t6);\n\n            case 40:\n              _this.setState({\n                submitted: false\n              });\n\n              Alert.alert(\"You left. Good bye.\");\n\n            case 42:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, null, null, [[6, 21]], Promise);\n    };\n\n    return _this;\n  }\n\n  _createClass(Home, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var setEnterRegion;\n      return _regeneratorRuntime.async(function componentDidMount$(_context7) {\n        while (1) {\n          switch (_context7.prev = _context7.next) {\n            case 0:\n              _context7.next = 2;\n              return _regeneratorRuntime.awrap(Font.loadAsync({\n                Roboto: require('native-base/Fonts/Roboto.ttf'),\n                Roboto_medium: require('native-base/Fonts/Roboto_medium.ttf')\n              }));\n\n            case 2:\n              if (firebase.auth().currentUser.emailVerified == false) {\n                Alert.alert(\"ALERT!\", \"Please verify your email first.\", [{\n                  text: \"OK\"\n                }], {\n                  cancelable: false\n                });\n                this.logout();\n              }\n\n              this.readFireBase();\n              this.getLocationsPermissions();\n              this.checkedIn();\n              setEnterRegion = this.props.setEnterRegion;\n              configureBgTasks({\n                setEnterRegion: setEnterRegion\n              });\n              this.startBackgroundUpdate();\n              this.startGeofence();\n\n            case 10:\n            case \"end\":\n              return _context7.stop();\n          }\n        }\n      }, null, this, null, Promise);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 489,\n          columnNumber: 7\n        }\n      }, React.createElement(PageTemplate, {\n        title: \"Home\",\n        logout: this.logout,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 490,\n          columnNumber: 9\n        }\n      }), React.createElement(View, {\n        style: styles.container,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 491,\n          columnNumber: 9\n        }\n      }, React.createElement(View, {\n        style: styles.bubble,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 492,\n          columnNumber: 11\n        }\n      }, React.createElement(TouchableOpacity, {\n        onPress: function onPress() {\n          _this2.props.onModalOne();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 493,\n          columnNumber: 11\n        }\n      }, React.createElement(MaterialCommunityIcons, {\n        name: \"target\",\n        size: 50,\n        color: \"white\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 495,\n          columnNumber: 13\n        }\n      }))), React.createElement(View, {\n        style: styles.container,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 500,\n          columnNumber: 11\n        }\n      }, React.createElement(TouchableOpacity, {\n        style: {\n          position: \"absolute\",\n          borderWidth: 1,\n          borderColor: \"rgba(0,0,0,0.2)\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n          width: 170,\n          height: 170,\n          backgroundColor: this.state.submitted == false ? \"#eb6e3d\" : \"green\",\n          borderRadius: 100,\n          shadowColor: \"rgba(0,0,0, .4)\",\n          shadowOffset: {\n            height: 1,\n            width: 1\n          },\n          shadowOpacity: 1,\n          shadowRadius: 1,\n          elevation: 15,\n          zIndex: 1\n        },\n        onPress: this.handleButton,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 501,\n          columnNumber: 13\n        }\n      }, this.state.submitted == false ? React.createElement(Entypo, {\n        name: \"location\",\n        size: 60,\n        color: \"white\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 524,\n          columnNumber: 17\n        }\n      }) : React.createElement(MaterialCommunityIcons, {\n        name: \"exit-run\",\n        size: 60,\n        color: \"white\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 527,\n          columnNumber: 17\n        }\n      }), this.state.submitted == false ? React.createElement(Text, {\n        style: {\n          color: 'white',\n          fontSize: 15\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 530,\n          columnNumber: 15\n        }\n      }, \"Check In\") : React.createElement(Text, {\n        style: {\n          color: 'white',\n          fontSize: 15\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 531,\n          columnNumber: 19\n        }\n      }, \"Check Out\")), this.state.submittedAnimation == false ? React.createElement(Animatable.View, {\n        animation: \"zoomIn\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 536,\n          columnNumber: 15\n        }\n      }, React.createElement(Animated.Image, {\n        source: background,\n        resizeMode: \"cover\",\n        style: {\n          zIndex: 0,\n          justifyContent: \"center\",\n          width: 80,\n          height: 80,\n          opacity: 0.2,\n          transform: [{\n            translateX: this.state.animatedValue.interpolate({\n              inputRange: [0, 80],\n              outputRange: [0, 1]\n            })\n          }, {\n            translateY: this.state.animatedValue.interpolate({\n              inputRange: [0, 80],\n              outputRange: [0, 1]\n            })\n          }, {\n            scaleX: this.state.animatedValue.interpolate({\n              inputRange: [1, 15],\n              outputRange: [0, 1]\n            })\n          }, {\n            scaleY: this.state.animatedValue.interpolate({\n              inputRange: [1, 15],\n              outputRange: [0, 1]\n            })\n          }]\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 537,\n          columnNumber: 17\n        }\n      })) : React.createElement(Animatable.View, {\n        animation: \"zoomOut\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 576,\n          columnNumber: 15\n        }\n      }, React.createElement(Animated.Image, {\n        source: background,\n        resizeMode: \"cover\",\n        style: {\n          zIndex: 0,\n          justifyContent: \"center\",\n          width: 80,\n          height: 80,\n          opacity: 0.2,\n          transform: [{\n            translateX: this.state.animatedValue.interpolate({\n              inputRange: [0, 80],\n              outputRange: [0, 1]\n            })\n          }, {\n            translateY: this.state.animatedValue.interpolate({\n              inputRange: [0, 80],\n              outputRange: [0, 1]\n            })\n          }, {\n            scaleX: this.state.animatedValue.interpolate({\n              inputRange: [1, 15],\n              outputRange: [0, 1]\n            })\n          }, {\n            scaleY: this.state.animatedValue.interpolate({\n              inputRange: [1, 15],\n              outputRange: [0, 1]\n            })\n          }]\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 577,\n          columnNumber: 17\n        }\n      }))), React.createElement(View, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 617,\n          columnNumber: 11\n        }\n      }, React.createElement(Text, {\n        style: {\n          fontSize: 25,\n          fontStyle: 'italic'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 617,\n          columnNumber: 17\n        }\n      }, this.props.reducer.playgroundName)), this.state.submittedAnimation && React.createElement(View, {\n        style: styles.loading,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 638,\n          columnNumber: 13\n        }\n      }, React.createElement(ActivityIndicator, {\n        animating: this.state.submittedAnimation,\n        style: {\n          left: \"0.5%\",\n          bottom: \"40%\"\n        },\n        size: \"large\",\n        color: \"white\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 639,\n          columnNumber: 15\n        }\n      }))), React.createElement(PlaygroundModal, {\n        checkIfChecked: function checkIfChecked() {\n          return _this2.checkedIn();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 648,\n          columnNumber: 9\n        }\n      }));\n    }\n  }]);\n\n  return Home;\n}(Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  var reducer = state.reducer;\n  return {\n    reducer: reducer\n  };\n};\n\nvar mapDispachToProps = function mapDispachToProps(dispatch) {\n  return {\n    setEmailData: function setEmailData(y) {\n      return dispatch({\n        type: \"SET_EMAIL_DATA\",\n        value: y\n      });\n    },\n    setUserData: function setUserData(y) {\n      return dispatch({\n        type: \"SET_USER_DATA\",\n        value: y\n      });\n    },\n    setSiteData: function setSiteData(y) {\n      return dispatch({\n        type: \"SET_SITE_DATA\",\n        value: y\n      });\n    },\n    onModalOne: function onModalOne() {\n      return dispatch({\n        type: \"CLOSE_MODAL_1\",\n        value: true\n      });\n    }\n  };\n};\n\nexport default connect(mapStateToProps, mapDispachToProps)(Home);\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: \"#fff\",\n    alignItems: \"center\",\n    justifyContent: \"center\"\n  },\n  logout: _objectSpread(_objectSpread({}, StyleSheet.absoluteFillObject), {}, {\n    alignSelf: \"flex-end\",\n    marginTop: -5\n  }),\n  titleText: {\n    fontSize: 15,\n    fontWeight: \"bold\",\n    color: \"white\"\n  },\n  bubble: {\n    position: \"absolute\",\n    top: \"-5%\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    width: \"15%\",\n    height: \"10%\",\n    marginLeft: \"32%\",\n    marginRight: \"32%\",\n    padding: 5,\n    borderRadius: 50,\n    paddingBottom: 5,\n    backgroundColor: \"#4aa0cf\",\n    shadowColor: \"black\",\n    shadowOffset: {\n      height: 4,\n      width: 0\n    },\n    shadowOpacity: 0.5,\n    shadowRadius: 1,\n    elevation: 15,\n    zIndex: 9999\n  },\n  bubble1: {\n    position: \"absolute\",\n    top: 120,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    width: \"80%\",\n    height: \"4%\",\n    margin: 6,\n    padding: 5,\n    borderRadius: 20,\n    paddingBottom: 5,\n    backgroundColor: \"#4aa0cf\",\n    shadowColor: \"#499ecc\",\n    shadowOffset: {\n      height: 6,\n      width: 2\n    },\n    shadowOpacity: 1,\n    shadowRadius: 1,\n    elevation: 5\n  },\n  image: {\n    zIndex: 0,\n    justifyContent: \"center\",\n    width: \"100%\",\n    height: \"100%\",\n    opacity: 0.19\n  },\n  loading: {\n    position: \"absolute\",\n    left: 0,\n    right: 0,\n    top: 0,\n    bottom: 0,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    height: \"100%\",\n    backgroundColor: \"#666570\",\n    opacity: 0.8\n  }\n});","map":{"version":3,"sources":["/Users/verycool/Desktop/reactNative/geohut_sport/components/Home.js"],"names":["React","Component","Button","Font","firebase","Entypo","MaterialCommunityIcons","Permissions","Location","getDistance","Animatable","background","PageTemplate","connect","PlaygroundModal","configureBgTasks","TASK_FETCH_LOCATION","moment","require","x","Home","uid","auth","currentUser","state","submitted","preSubmitted","proximity","hasLocationPermission","proximityMax","siteLocation","latitude","longitude","submittedAnimation","animatedValue","Animated","Value","volleyballCourt","startGeofence","console","log","startGeofencingAsync","identifier","radius","notifyOnEnter","notifyOnExit","startBackgroundUpdate","startLocationUpdatesAsync","accuracy","Accuracy","Highest","distanceInterval","deferredUpdatesInterval","foregroundService","notificationTitle","notificationBody","checkedIn","database","ref","once","snapshot","data","val","fetch","email","then","res","json","some","e","checkin_datetime","substr","utcOffset","format","site_id","props","reducer","playgroundId","setState","catch","error","readFireBase","setUserData","firstName","lastName","user_id","getLocationsPermissions","getAsync","LOCATION","status","askAsync","errorMessage","logout","signOut","navigation","navigate","getCurrentLoc","getCurrentPositionAsync","location","JSON","stringify","eval","Alert","alert","calculateDistance","start_x","start_y","end_x","end_y","distance","handleButton","parseFloat","coords","playgroundLat","playgroundLon","userInfo","method","loadAsync","Roboto","Roboto_medium","emailVerified","text","cancelable","setEnterRegion","styles","container","bubble","onModalOne","position","borderWidth","borderColor","alignItems","justifyContent","width","height","backgroundColor","borderRadius","shadowColor","shadowOffset","shadowOpacity","shadowRadius","elevation","zIndex","color","fontSize","opacity","transform","translateX","interpolate","inputRange","outputRange","translateY","scaleX","scaleY","fontStyle","playgroundName","loading","left","bottom","mapStateToProps","mapDispachToProps","dispatch","setEmailData","y","type","value","setSiteData","StyleSheet","create","flex","absoluteFillObject","alignSelf","marginTop","titleText","fontWeight","top","marginLeft","marginRight","padding","paddingBottom","bubble1","margin","image","right"],"mappings":";;;;;;;;;;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;;;;;;;;AAUA,SAASC,MAAT,QAAuB,aAAvB;AACA,OAAO,KAAKC,IAAZ,MAAsB,WAAtB;AACA,OAAO,KAAKC,QAAZ,MAA0B,UAA1B;AACA,SAASC,MAAT,QAAuB,oBAAvB;AACA,SAASC,sBAAT,QAAuC,oBAAvC;AAEA,OAAO,KAAKC,WAAZ,MAA6B,kBAA7B;AACA,OAAO,KAAKC,QAAZ,MAA0B,eAA1B;AACA,SAASC,WAAT,QAA4B,QAA5B;AACA,OAAO,KAAKC,UAAZ,MAA4B,yBAA5B;AACA,OAAOC,UAAP;AACA,OAAOC,YAAP;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,OAAOC,eAAP;AAGA,SAASC,gBAAT;AACA,IAAMC,mBAAmB,GAAG,qBAA5B;;AAEA,IAAMC,MAAM,GAAGC,OAAO,CAAC,QAAD,CAAtB;;AAQA,IAAIC,CAAC,GAAG,qCAAR;;IAEMC,I;;;;;;;;;;;;;;;UAEJC,G,GAAMjB,QAAQ,CAACkB,IAAT,GAAgBC,WAAhB,CAA4BF,G;UAElCG,K,GAAQ;AACNC,MAAAA,SAAS,EAAE,KADL;AAENC,MAAAA,YAAY,EAAE,KAFR;AAGNC,MAAAA,SAAS,EAAE,IAHL;AAINC,MAAAA,qBAAqB,EAAE,IAJjB;AAKNC,MAAAA,YAAY,EAAE,GALR;AAMNC,MAAAA,YAAY,EAAE;AAAEC,QAAAA,QAAQ,EAAE,IAAZ;AAAkBC,QAAAA,SAAS,EAAE;AAA7B,OANR;AAONC,MAAAA,kBAAkB,EAAE,KAPd;AAQNC,MAAAA,aAAa,EAAE,IAAIC,QAAQ,CAACC,KAAb,CAAmB,EAAnB,CART;AAULC,MAAAA,eAAe,EAAE;AAGhBN,QAAAA,QAAQ,EAAE,SAHM;AAIhBC,QAAAA,SAAS,EAAE,CAAC;AAJI;AAVZ,K;;UAmFVM,a,GAAgB;AAAA;AAAA;AAAA;AAAA;AACdC,cAAAA,OAAO,CAACC,GAAR,CAAY,8BAAZ;AAEAhC,cAAAA,QAAQ,CAACiC,oBAAT,CAA8B,qBAA9B,EACE,CACA;AACEC,gBAAAA,UAAU,EAAE,OADd;AAEEX,gBAAAA,QAAQ,EAAE,MAAKP,KAAL,CAAWa,eAAX,CAA2BN,QAFvC;AAGEC,gBAAAA,SAAS,EAAE,MAAKR,KAAL,CAAWa,eAAX,CAA2BL,SAHxC;AAIEW,gBAAAA,MAAM,EAAE,GAJV;AAKEC,gBAAAA,aAAa,EAAE,IALjB;AAMEC,gBAAAA,YAAY,EAAE;AANhB,eADA,CADF;;AAHc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,K;;UAkBhBC,qB,GAAwB;AAAA;AAAA;AAAA;AAAA;AACtBtC,cAAAA,QAAQ,CAACuC,yBAAT,CAAmC/B,mBAAnC,EAAwD;AACtDgC,gBAAAA,QAAQ,EAAExC,QAAQ,CAACyC,QAAT,CAAkBC,OAD0B;AAEtDC,gBAAAA,gBAAgB,EAAE,CAFoC;AAGtDC,gBAAAA,uBAAuB,EAAE,IAH6B;AAKtDC,gBAAAA,iBAAiB,EAAE;AACjBC,kBAAAA,iBAAiB,EAAE,qBADF;AAEjBC,kBAAAA,gBAAgB,EAAE;AAFD;AALmC,eAAxD;;AADsB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,K;;UAexBC,S,GAAY,YAAK;AACjBjB,MAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ;AACEpC,MAAAA,QAAQ,CAACqD,QAAT,GAAoBC,GAApB,CAAwB,eAAc,MAAKrC,GAAnB,GAAyB,OAAjD,EAA0DsC,IAA1D,CAA+D,OAA/D,EAAwE,UAAAC,QAAQ,EAAI;AAElF,YAAIC,IAAI,GAAGD,QAAQ,CAACE,GAAT,EAAX;AAIAC,QAAAA,KAAK,CAAI5C,CAAJ,sBAAsB0C,IAAI,CAACG,KAA3B,CAAL,CACCC,IADD,CACM,UAAAC,GAAG;AAAA,iBAAIA,GAAG,CAACC,IAAJ,EAAJ;AAAA,SADT,EAECF,IAFD,CAEM,UAAAC,GAAG,EAAI;AAEX,cAAIA,GAAG,CAAC,MAAD,CAAH,CAAYE,IAAZ,CAAiB,UAAAC,CAAC;AAAA,mBAAIA,CAAC,CAACC,gBAAF,CAAmBC,MAAnB,CAA0B,CAA1B,EAA4B,EAA5B,MAAoCtD,MAAM,GAAGuD,SAAT,CAAmB,OAAnB,EAA4BC,MAA5B,CAAmC,YAAnC,CAAxC;AAAA,WAAlB,KAA+GP,GAAG,CAAC,MAAD,CAAH,CAAYE,IAAZ,CAAiB,UAAAC,CAAC;AAAA,mBAAIA,CAAC,CAACK,OAAF,KAAc,MAAKC,KAAL,CAAWC,OAAX,CAAmBC,YAArC;AAAA,WAAlB,CAAnH,EAAwL;AACtL,kBAAKC,QAAL,CAAc;AAACrD,cAAAA,SAAS,EAAE;AAAZ,aAAd;;AACAc,YAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ;AACD,WAHD,MAGO;AACL,kBAAKsC,QAAL,CAAc;AAACrD,cAAAA,SAAS,EAAE;AAAZ,aAAd;AACD;AACF,SAVD,EAWCsD,KAXD,CAWO,UAACC,KAAD,EAAW;AAChBzC,UAAAA,OAAO,CAACC,GAAR,CAAYwC,KAAZ;AACD,SAbD;AAcC,OApBH;AAsBD,K;;UAICC,Y,GAAe,YAAM;AACnB7E,MAAAA,QAAQ,CAACqD,QAAT,GAAoBC,GAApB,CAAwB,eAAc,MAAKrC,GAAnB,GAAyB,OAAjD,EAA0DsC,IAA1D,CAA+D,OAA/D,EAAwE,UAAAC,QAAQ,EAAI;AAElF,YAAIC,IAAI,GAAGD,QAAQ,CAACE,GAAT,EAAX;;AAEE,cAAKa,KAAL,CAAWO,WAAX,CAAuB;AACrBC,UAAAA,SAAS,EAAEtB,IAAI,CAACsB,SADK;AAErBC,UAAAA,QAAQ,EAAEvB,IAAI,CAACuB,QAFM;AAGrBC,UAAAA,OAAO,EAAExB,IAAI,CAACG;AAHO,SAAvB;AAKD,OATH;AAUD,K;;UAyEDsB,uB,GAA0B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+CAET/E,WAAW,CAACgF,QAAZ,CAAqBhF,WAAW,CAACiF,QAAjC,CAFS;;AAAA;AAExBC,cAAAA,MAFwB;;AAAA,oBAGpBA,MAAM,CAACA,MAAP,KAAkB,SAHE;AAAA;AAAA;AAAA;;AAAA;AAAA,+CAIPlF,WAAW,CAACmF,QAAZ,CAAqBnF,WAAW,CAACiF,QAAjC,CAJO;;AAAA;AAItBC,cAAAA,MAJsB;;AAAA;AAIoC;;AAC5D,kBAAIA,MAAM,CAACA,MAAP,KAAkB,SAAtB,EAAiC;AAC/B,sBAAKX,QAAL,CAAc;AACZa,kBAAAA,YAAY,EAAE;AADF,iBAAd;AAGD,eAJD,MAIO;AACL,sBAAKb,QAAL,CAAc;AAAElD,kBAAAA,qBAAqB,EAAE6D;AAAzB,iBAAd;AACD;;AAXuB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,K;;UAe1BG,M,GAAS,YAAM;AACbxF,MAAAA,QAAQ,CACLkB,IADH,GAEGuE,OAFH,GAGGd,KAHH,CAGS,UAACC,KAAD;AAAA,eAAWzC,OAAO,CAACC,GAAR,CAAYwC,KAAZ,CAAX;AAAA,OAHT;;AAKA,YAAKL,KAAL,CAAWmB,UAAX,CAAsBC,QAAtB,CAA+B,aAA/B;AACD,K;;UAGDC,a,GAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+CAESxF,QAAQ,CAACyF,uBAAT,CAAiC,EAAjC,CAFT;;AAAA;AAERC,cAAAA,QAFQ;AAAA;AAAA,+CAGKC,IAAI,CAACC,SAAL,CAAeF,QAAf,CAHL;;AAAA;AAGZA,cAAAA,QAHY;AAAA;AAAA,+CAIKG,IAAI,CAAC,MAAM,GAAN,GAAYH,QAAZ,GAAuB,GAAvB,GAA6B,GAA9B,CAJT;;AAAA;AAIZA,cAAAA,QAJY;AAAA,gDAMLA,QANK;;AAAA;AAAA;AAAA;AAQZI,cAAAA,KAAK,CAACC,KAAN,CAAY,wDAAZ;;AARY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,K;;UAahBC,iB,GAAoB,kBAAOC,OAAP,EAAeC,OAAf,EAAwBC,KAAxB,EAA8BC,KAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+CAEKnG,WAAW,CAC9B;AACEsB,gBAAAA,QAAQ,EAAE0E,OADZ;AAEEzE,gBAAAA,SAAS,EAAE0E;AAFb,eAD8B,EAK9B;AACE3E,gBAAAA,QAAQ,EAAE4E,KADZ;AAEE3E,gBAAAA,SAAS,EAAE4E;AAFb,eAL8B,EAS7B5D,QAAQ,GAAG,GATkB,CAFhB;;AAAA;AAEZ6D,cAAAA,QAFY;AAahBtE,cAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ;AAbgB,gDAcTqE,QAdS;;AAAA;AAAA;AAAA;AAiBhBN,cAAAA,KAAK,CAAC,gEAAD,CAAL;;AAjBgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,K;;UAyEpBO,Y,GAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAEb,MAAKnC,KAAL,CAAWC,OAAX,CAAmBC,YAAnB,KAAoC,EAFvB;AAAA;AAAA;AAAA;;AAGfyB,cAAAA,KAAK,CAACC,KAAN,CAAY,+BAAZ;AAHe;AAAA;;AAAA;AAAA,oBAIN,MAAK/E,KAAL,CAAWC,SAAX,KAAyB,KAJnB;AAAA;AAAA;AAAA;;AAKX,oBAAKqD,QAAL,CAAc;AAAE7C,gBAAAA,kBAAkB,EAAE;AAAtB,eAAd;;AALW;AAAA;AAAA,+CAQY,MAAK+D,aAAL,EARZ;;AAAA;AAQLE,cAAAA,QARK;AAST3D,cAAAA,OAAO,CAACC,GAAR,CAAYuE,UAAU,CAACb,QAAQ,CAAC,CAAD,CAAR,CAAYc,MAAZ,CAAmBjF,QAApB,CAAtB;AACAQ,cAAAA,OAAO,CAACC,GAAR,CAAYuE,UAAU,CAACb,QAAQ,CAAC,CAAD,CAAR,CAAYc,MAAZ,CAAmBhF,SAApB,CAAtB;AACAO,cAAAA,OAAO,CAACC,GAAR,CAAY,MAAKmC,KAAL,CAAWC,OAAX,CAAmBqC,aAA/B;AACA1E,cAAAA,OAAO,CAACC,GAAR,CAAY,MAAKmC,KAAL,CAAWC,OAAX,CAAmBsC,aAA/B;AAZS;AAAA,+CAcY,MAAKV,iBAAL,CACnBO,UAAU,CAACb,QAAQ,CAAC,CAAD,CAAR,CAAYc,MAAZ,CAAmBjF,QAApB,CADS,EAEnBgF,UAAU,CAACb,QAAQ,CAAC,CAAD,CAAR,CAAYc,MAAZ,CAAmBhF,SAApB,CAFS,EAGnB,MAAK2C,KAAL,CAAWC,OAAX,CAAmBqC,aAHA,EAInB,MAAKtC,KAAL,CAAWC,OAAX,CAAmBsC,aAJA,CAdZ;;AAAA;AAcLL,cAAAA,QAdK;AAoBTtE,cAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ,EAA0BqE,QAA1B;;AAGA,kBAAIA,QAAQ,IAAI,MAAKrF,KAAL,CAAWK,YAA3B,EAAyC;AAGvCkC,gBAAAA,KAAK,CAEA5C,CAFA,mBAGDF,MAAM,GACHuD,SADH,CACa,OADb,EAEGC,MAFH,CAEU,qBAFV,EAGGF,MAHH,CAGU,CAHV,EAGa,EAHb,IAGmB,GANlB,kBAOS,MAAKI,KAAL,CAAWC,OAAX,CAAmBC,YAP5B,oBAOuD,MAAKF,KAAL,CAAWC,OAAX,CAAmBuC,QAAnB,CAA4BhC,SAPnF,iCAQU,MAAKR,KAAL,CAAWC,OAAX,CAAmBuC,QAAnB,CAA4B/B,QARtC,iBAQ0D,MAAKT,KAAL,CAAWC,OAAX,CAAmBuC,QAAnB,CAA4B9B,OARtF,EASH;AAAE+B,kBAAAA,MAAM,EAAE;AAAV,iBATG,CAAL,CAUErC,KAVF,CAUQ,UAACC,KAAD,EAAW;AACjBzC,kBAAAA,OAAO,CAACC,GAAR,CAAYwC,KAAZ;AACD,iBAZD;;AAmBA,sBAAKF,QAAL,CAAc;AAAErD,kBAAAA,SAAS,EAAE;AAAb,iBAAd;AACD,eAvBD,MAuBO;AAEL6E,gBAAAA,KAAK,CAACC,KAAN,CAAY,gDAAZ;AACD;;AAjDQ;AAAA;;AAAA;AAAA;AAAA;AAmDThE,cAAAA,OAAO,CAACC,GAAR;;AAnDS;AAqDX,oBAAKsC,QAAL,CAAc;AAAE7C,gBAAAA,kBAAkB,EAAE;AAAtB,eAAd;;AArDW;AAAA;;AAAA;AAuDjBM,cAAAA,OAAO,CAACC,GAAR,CAAY,MAAKmC,KAAL,CAAWC,OAAX,CAAmBC,YAA/B;AAvDiB;AAAA,6BAyDXd,KAAK,CAEN5C,CAFM,wBAEc,MAAKwD,KAAL,CAAWC,OAAX,CAAmBC,YAFjC,iBAEyD,MAAKF,KAAL,CAAWC,OAAX,CAAmBuC,QAAnB,CAA4B9B,OAFrF,EAGT;AAAE+B,gBAAAA,MAAM,EAAE;AAAV,eAHS,CAAL,CAIJrC,KAJI,CAIE,UAACC,KAAD,EAAW;AACjBzC,gBAAAA,OAAO,CAACC,GAAR,CAAYwC,KAAZ;AACD,eANK,CAzDW;AAAA;AAAA,+CAiEXjB,KAAK,CAEN5C,CAFM,8BAEoB,MAAKwD,KAAL,CAAWC,OAAX,CAAmBC,YAFvC,iBAE+D,MAAKF,KAAL,CAAWC,OAAX,CAAmBuC,QAAnB,CAA4B9B,OAF3F,EAGT;AAAE+B,gBAAAA,MAAM,EAAE;AAAV,eAHS,CAAL,CAIJrC,KAJI,CAIE,UAACC,KAAD,EAAW;AACjBzC,gBAAAA,OAAO,CAACC,GAAR,CAAYwC,KAAZ;AACD,eANK,CAjEW;;AAAA;AAAA;AAAA,0CA+Ddf,IA/Dc;AAAA;AAAA,+CAwETF,KAAK,CAEN5C,CAFM,wBAEc,MAAKwD,KAAL,CAAWC,OAAX,CAAmBC,YAFjC,iBAEyD,MAAKF,KAAL,CAAWC,OAAX,CAAmBuC,QAAnB,CAA4B9B,OAFrF,EAGT;AAAE+B,gBAAAA,MAAM,EAAE;AAAV,eAHS,CAAL,CAIJrC,KAJI,CAIE,UAACC,KAAD,EAAW;AACjBzC,gBAAAA,OAAO,CAACC,GAAR,CAAYwC,KAAZ;AACD,eANK,CAxES;;AAAA;AAAA;AAAA,0CAuEbf,IAvEa,kCA+EfA,IA/Ee,CAgFf,MAAKa,QAAL,CAAc;AAAErD,gBAAAA,SAAS,EAAE;AAAb,eAAd,CAhFe,EAkFf6E,KAAK,CAACC,KAAN,CACE,qBADF,CAlFe;AAAA;AAAA;;AAAA;AA4FX,oBAAKzB,QAAL,CAAc;AAAErD,gBAAAA,SAAS,EAAE;AAAb,eAAd;;AAEA6E,cAAAA,KAAK,CAACC,KAAN,CACE,qBADF;;AA9FW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,K;;;;;;;;;;;;;;+CAhUHpG,IAAI,CAACkH,SAAL,CAAe;AACvBC,gBAAAA,MAAM,EAAEpG,OAAO,CAAC,8BAAD,CADQ;AAEvBqG,gBAAAA,aAAa,EAAErG,OAAO,CAAC,qCAAD;AAFC,eAAf,C;;;AAKV,kBAAId,QAAQ,CAACkB,IAAT,GAAgBC,WAAhB,CAA4BiG,aAA5B,IAA6C,KAAjD,EAAwD;AACtDlB,gBAAAA,KAAK,CAACC,KAAN,CACE,QADF,EAEE,iCAFF,EAGE,CAAC;AAAEkB,kBAAAA,IAAI,EAAE;AAAR,iBAAD,CAHF,EAIE;AAAEC,kBAAAA,UAAU,EAAE;AAAd,iBAJF;AAMA,qBAAK9B,MAAL;AACD;;AAGD,mBAAKX,YAAL;AAMA,mBAAKK,uBAAL;AAOA,mBAAK9B,SAAL;AAGOmE,cAAAA,c,GAAkB,KAAKhD,K,CAAvBgD,c;AACP5G,cAAAA,gBAAgB,CAAC;AAAE4G,gBAAAA,cAAc,EAAdA;AAAF,eAAD,CAAhB;AAEA,mBAAK7E,qBAAL;AACA,mBAAKR,aAAL;;;;;;;;;;;6BAkYO;AAAA;;AAGP,aACE,oBAAC,KAAD,CAAO,QAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,YAAD;AAAc,QAAA,KAAK,EAAE,MAArB;AAA6B,QAAA,MAAM,EAAE,KAAKsD,MAA1C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,EAEE,oBAAC,IAAD;AAAM,QAAA,KAAK,EAAEgC,MAAM,CAACC,SAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,IAAD;AAAM,QAAA,KAAK,EAAED,MAAM,CAACE,MAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACA,oBAAC,gBAAD;AAAkB,QAAA,OAAO,EAAE,mBAAM;AACzB,UAAA,MAAI,CAACnD,KAAL,CAAWoD,UAAX;AAAwB,SADhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAEE,oBAAC,sBAAD;AAAwB,QAAA,IAAI,EAAC,QAA7B;AAAsC,QAAA,IAAI,EAAE,EAA5C;AAAgD,QAAA,KAAK,EAAC,OAAtD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFF,CADA,CADF,EASE,oBAAC,IAAD;AAAM,QAAA,KAAK,EAAEH,MAAM,CAACC,SAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,gBAAD;AAEE,QAAA,KAAK,EAAE;AACLG,UAAAA,QAAQ,EAAE,UADL;AAELC,UAAAA,WAAW,EAAE,CAFR;AAGLC,UAAAA,WAAW,EAAE,iBAHR;AAILC,UAAAA,UAAU,EAAE,QAJP;AAKLC,UAAAA,cAAc,EAAE,QALX;AAMLC,UAAAA,KAAK,EAAE,GANF;AAOLC,UAAAA,MAAM,EAAE,GAPH;AAQLC,UAAAA,eAAe,EACb,KAAK/G,KAAL,CAAWC,SAAX,IAAwB,KAAxB,GAAgC,SAAhC,GAA4C,OATzC;AAUL+G,UAAAA,YAAY,EAAE,GAVT;AAWLC,UAAAA,WAAW,EAAE,iBAXR;AAYLC,UAAAA,YAAY,EAAE;AAAEJ,YAAAA,MAAM,EAAE,CAAV;AAAaD,YAAAA,KAAK,EAAE;AAApB,WAZT;AAaLM,UAAAA,aAAa,EAAE,CAbV;AAcLC,UAAAA,YAAY,EAAE,CAdT;AAeLC,UAAAA,SAAS,EAAE,EAfN;AAgBLC,UAAAA,MAAM,EAAE;AAhBH,SAFT;AAoBE,QAAA,OAAO,EAAE,KAAKhC,YApBhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAsBG,KAAKtF,KAAL,CAAWC,SAAX,IAAwB,KAAxB,GACC,oBAAC,MAAD;AAAQ,QAAA,IAAI,EAAC,UAAb;AAAwB,QAAA,IAAI,EAAE,EAA9B;AAAkC,QAAA,KAAK,EAAC,OAAxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADD,GAIC,oBAAC,sBAAD;AAAwB,QAAA,IAAI,EAAC,UAA7B;AAAwC,QAAA,IAAI,EAAE,EAA9C;AAAkD,QAAA,KAAK,EAAC,OAAxD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QA1BJ,EA4BG,KAAKD,KAAL,CAAWC,SAAX,IAAwB,KAAxB,GACD,oBAAC,IAAD;AAAM,QAAA,KAAK,EAAI;AAACsH,UAAAA,KAAK,EAAC,OAAP;AAAgBC,UAAAA,QAAQ,EAAC;AAAzB,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADC,GAEG,oBAAC,IAAD;AAAM,QAAA,KAAK,EAAI;AAACD,UAAAA,KAAK,EAAC,OAAP;AAAgBC,UAAAA,QAAQ,EAAC;AAAzB,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBA9BN,CADF,EAmCG,KAAKxH,KAAL,CAAWS,kBAAX,IAAiC,KAAjC,GACC,oBAAC,UAAD,CAAY,IAAZ;AAAiB,QAAA,SAAS,EAAC,QAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,QAAD,CAAU,KAAV;AACE,QAAA,MAAM,EAAEtB,UADV;AAEE,QAAA,UAAU,EAAC,OAFb;AAGE,QAAA,KAAK,EAAE;AACLmI,UAAAA,MAAM,EAAE,CADH;AAELV,UAAAA,cAAc,EAAE,QAFX;AAGLC,UAAAA,KAAK,EAAE,EAHF;AAILC,UAAAA,MAAM,EAAE,EAJH;AAKLW,UAAAA,OAAO,EAAE,GALJ;AAMLC,UAAAA,SAAS,EAAE,CACT;AACEC,YAAAA,UAAU,EAAE,KAAK3H,KAAL,CAAWU,aAAX,CAAyBkH,WAAzB,CAAqC;AAC/CC,cAAAA,UAAU,EAAE,CAAC,CAAD,EAAI,EAAJ,CADmC;AAE/CC,cAAAA,WAAW,EAAE,CAAC,CAAD,EAAI,CAAJ;AAFkC,aAArC;AADd,WADS,EAOT;AACEC,YAAAA,UAAU,EAAE,KAAK/H,KAAL,CAAWU,aAAX,CAAyBkH,WAAzB,CAAqC;AAC/CC,cAAAA,UAAU,EAAE,CAAC,CAAD,EAAI,EAAJ,CADmC;AAE/CC,cAAAA,WAAW,EAAE,CAAC,CAAD,EAAI,CAAJ;AAFkC,aAArC;AADd,WAPS,EAaT;AACEE,YAAAA,MAAM,EAAE,KAAKhI,KAAL,CAAWU,aAAX,CAAyBkH,WAAzB,CAAqC;AAC3CC,cAAAA,UAAU,EAAE,CAAC,CAAD,EAAI,EAAJ,CAD+B;AAE3CC,cAAAA,WAAW,EAAE,CAAC,CAAD,EAAI,CAAJ;AAF8B,aAArC;AADV,WAbS,EAmBT;AACEG,YAAAA,MAAM,EAAE,KAAKjI,KAAL,CAAWU,aAAX,CAAyBkH,WAAzB,CAAqC;AAC3CC,cAAAA,UAAU,EAAE,CAAC,CAAD,EAAI,EAAJ,CAD+B;AAE3CC,cAAAA,WAAW,EAAE,CAAC,CAAD,EAAI,CAAJ;AAF8B,aAArC;AADV,WAnBS;AANN,SAHT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,CADD,GAyCC,oBAAC,UAAD,CAAY,IAAZ;AAAiB,QAAA,SAAS,EAAC,SAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,QAAD,CAAU,KAAV;AACE,QAAA,MAAM,EAAE3I,UADV;AAEE,QAAA,UAAU,EAAC,OAFb;AAGE,QAAA,KAAK,EAAE;AACLmI,UAAAA,MAAM,EAAE,CADH;AAELV,UAAAA,cAAc,EAAE,QAFX;AAGLC,UAAAA,KAAK,EAAE,EAHF;AAILC,UAAAA,MAAM,EAAE,EAJH;AAKLW,UAAAA,OAAO,EAAE,GALJ;AAMLC,UAAAA,SAAS,EAAE,CACT;AACEC,YAAAA,UAAU,EAAE,KAAK3H,KAAL,CAAWU,aAAX,CAAyBkH,WAAzB,CAAqC;AAC/CC,cAAAA,UAAU,EAAE,CAAC,CAAD,EAAI,EAAJ,CADmC;AAE/CC,cAAAA,WAAW,EAAE,CAAC,CAAD,EAAI,CAAJ;AAFkC,aAArC;AADd,WADS,EAOT;AACEC,YAAAA,UAAU,EAAE,KAAK/H,KAAL,CAAWU,aAAX,CAAyBkH,WAAzB,CAAqC;AAC/CC,cAAAA,UAAU,EAAE,CAAC,CAAD,EAAI,EAAJ,CADmC;AAE/CC,cAAAA,WAAW,EAAE,CAAC,CAAD,EAAI,CAAJ;AAFkC,aAArC;AADd,WAPS,EAaT;AACEE,YAAAA,MAAM,EAAE,KAAKhI,KAAL,CAAWU,aAAX,CAAyBkH,WAAzB,CAAqC;AAC3CC,cAAAA,UAAU,EAAE,CAAC,CAAD,EAAI,EAAJ,CAD+B;AAE3CC,cAAAA,WAAW,EAAE,CAAC,CAAD,EAAI,CAAJ;AAF8B,aAArC;AADV,WAbS,EAmBT;AACEG,YAAAA,MAAM,EAAE,KAAKjI,KAAL,CAAWU,aAAX,CAAyBkH,WAAzB,CAAqC;AAC3CC,cAAAA,UAAU,EAAE,CAAC,CAAD,EAAI,EAAJ,CAD+B;AAE3CC,cAAAA,WAAW,EAAE,CAAC,CAAD,EAAI,CAAJ;AAF8B,aAArC;AADV,WAnBS;AANN,SAHT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,CA5EJ,CATF,EA8HE,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAM,oBAAC,IAAD;AAAM,QAAA,KAAK,EAAI;AAACN,UAAAA,QAAQ,EAAE,EAAX;AAAcU,UAAAA,SAAS,EAAE;AAAzB,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAoD,KAAK/E,KAAL,CAAWC,OAAX,CAAmB+E,cAAvE,CAAN,CA9HF,EAkJG,KAAKnI,KAAL,CAAWS,kBAAX,IACC,oBAAC,IAAD;AAAM,QAAA,KAAK,EAAE2F,MAAM,CAACgC,OAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,iBAAD;AACE,QAAA,SAAS,EAAE,KAAKpI,KAAL,CAAWS,kBADxB;AAEE,QAAA,KAAK,EAAE;AAAE4H,UAAAA,IAAI,EAAE,MAAR;AAAgBC,UAAAA,MAAM,EAAE;AAAxB,SAFT;AAGE,QAAA,IAAI,EAAC,OAHP;AAIE,QAAA,KAAK,EAAC,OAJR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,CAnJJ,CAFF,EA+JE,oBAAC,eAAD;AAAiB,QAAA,cAAc,EAAI;AAAA,iBAAM,MAAI,CAACtG,SAAL,EAAN;AAAA,SAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QA/JF,CADF;AAmKD;;;;EAnmBgBvD,S;;AAwmBnB,IAAM8J,eAAe,GAAG,SAAlBA,eAAkB,CAACvI,KAAD,EAAW;AAAA,MAEzBoD,OAFyB,GAEbpD,KAFa,CAEzBoD,OAFyB;AAGjC,SAAO;AAAEA,IAAAA,OAAO,EAAPA;AAAF,GAAP;AACD,CAJD;;AAMA,IAAMoF,iBAAiB,GAAG,SAApBA,iBAAoB,CAAAC,QAAQ,EAAI;AACpC,SAAO;AACLC,IAAAA,YAAY,EAAE,sBAACC,CAAD;AAAA,aAAOF,QAAQ,CAAC;AAAEG,QAAAA,IAAI,EAAE,gBAAR;AAA0BC,QAAAA,KAAK,EAAEF;AAAjC,OAAD,CAAf;AAAA,KADT;AAELjF,IAAAA,WAAW,EAAE,qBAACiF,CAAD;AAAA,aAAOF,QAAQ,CAAC;AAAEG,QAAAA,IAAI,EAAE,eAAR;AAAyBC,QAAAA,KAAK,EAAEF;AAAhC,OAAD,CAAf;AAAA,KAFR;AAGLG,IAAAA,WAAW,EAAE,qBAACH,CAAD;AAAA,aAAOF,QAAQ,CAAC;AAAEG,QAAAA,IAAI,EAAE,eAAR;AAAyBC,QAAAA,KAAK,EAAEF;AAAhC,OAAD,CAAf;AAAA,KAHR;AAILpC,IAAAA,UAAU,EAAE;AAAA,aAAMkC,QAAQ,CAAC;AAAEG,QAAAA,IAAI,EAAE,eAAR;AAAyBC,QAAAA,KAAK,EAAE;AAAhC,OAAD,CAAd;AAAA;AAJP,GAAP;AAMD,CAPD;;AASA,eAAexJ,OAAO,CAACkJ,eAAD,EAAkBC,iBAAlB,CAAP,CAA4C5I,IAA5C,CAAf;AAWA,IAAMwG,MAAM,GAAG2C,UAAU,CAACC,MAAX,CAAkB;AAC/B3C,EAAAA,SAAS,EAAE;AACT4C,IAAAA,IAAI,EAAE,CADG;AAETlC,IAAAA,eAAe,EAAE,MAFR;AAGTJ,IAAAA,UAAU,EAAE,QAHH;AAITC,IAAAA,cAAc,EAAE;AAJP,GADoB;AAO/BxC,EAAAA,MAAM,kCACD2E,UAAU,CAACG,kBADV;AAEJC,IAAAA,SAAS,EAAE,UAFP;AAGJC,IAAAA,SAAS,EAAE,CAAC;AAHR,IAPyB;AAa/BC,EAAAA,SAAS,EAAE;AACT7B,IAAAA,QAAQ,EAAE,EADD;AAET8B,IAAAA,UAAU,EAAE,MAFH;AAGT/B,IAAAA,KAAK,EAAE;AAHE,GAboB;AAkB/BjB,EAAAA,MAAM,EAAE;AACNE,IAAAA,QAAQ,EAAE,UADJ;AAEN+C,IAAAA,GAAG,EAAE,KAFC;AAGN5C,IAAAA,UAAU,EAAE,QAHN;AAINC,IAAAA,cAAc,EAAE,QAJV;AAKNC,IAAAA,KAAK,EAAE,KALD;AAMNC,IAAAA,MAAM,EAAE,KANF;AAON0C,IAAAA,UAAU,EAAE,KAPN;AAQNC,IAAAA,WAAW,EAAE,KARP;AASNC,IAAAA,OAAO,EAAE,CATH;AAUN1C,IAAAA,YAAY,EAAE,EAVR;AAWN2C,IAAAA,aAAa,EAAE,CAXT;AAYN5C,IAAAA,eAAe,EAAE,SAZX;AAaNE,IAAAA,WAAW,EAAE,OAbP;AAcNC,IAAAA,YAAY,EAAE;AAAEJ,MAAAA,MAAM,EAAE,CAAV;AAAaD,MAAAA,KAAK,EAAE;AAApB,KAdR;AAeNM,IAAAA,aAAa,EAAE,GAfT;AAgBNC,IAAAA,YAAY,EAAE,CAhBR;AAiBNC,IAAAA,SAAS,EAAE,EAjBL;AAkBNC,IAAAA,MAAM,EAAE;AAlBF,GAlBuB;AAsC/BsC,EAAAA,OAAO,EAAE;AACPpD,IAAAA,QAAQ,EAAE,UADH;AAEP+C,IAAAA,GAAG,EAAE,GAFE;AAGP5C,IAAAA,UAAU,EAAE,QAHL;AAIPC,IAAAA,cAAc,EAAE,QAJT;AAKPC,IAAAA,KAAK,EAAE,KALA;AAMPC,IAAAA,MAAM,EAAE,IAND;AAOP+C,IAAAA,MAAM,EAAE,CAPD;AAQPH,IAAAA,OAAO,EAAE,CARF;AASP1C,IAAAA,YAAY,EAAE,EATP;AAUP2C,IAAAA,aAAa,EAAE,CAVR;AAWP5C,IAAAA,eAAe,EAAE,SAXV;AAYPE,IAAAA,WAAW,EAAE,SAZN;AAaPC,IAAAA,YAAY,EAAE;AAAEJ,MAAAA,MAAM,EAAE,CAAV;AAAaD,MAAAA,KAAK,EAAE;AAApB,KAbP;AAcPM,IAAAA,aAAa,EAAE,CAdR;AAePC,IAAAA,YAAY,EAAE,CAfP;AAgBPC,IAAAA,SAAS,EAAE;AAhBJ,GAtCsB;AAwD/ByC,EAAAA,KAAK,EAAE;AACLxC,IAAAA,MAAM,EAAE,CADH;AAELV,IAAAA,cAAc,EAAE,QAFX;AAGLC,IAAAA,KAAK,EAAE,MAHF;AAILC,IAAAA,MAAM,EAAE,MAJH;AAKLW,IAAAA,OAAO,EAAE;AALJ,GAxDwB;AAgE/BW,EAAAA,OAAO,EAAE;AACP5B,IAAAA,QAAQ,EAAE,UADH;AAEP6B,IAAAA,IAAI,EAAE,CAFC;AAGP0B,IAAAA,KAAK,EAAE,CAHA;AAIPR,IAAAA,GAAG,EAAE,CAJE;AAKPjB,IAAAA,MAAM,EAAE,CALD;AAMP3B,IAAAA,UAAU,EAAE,QANL;AAOPC,IAAAA,cAAc,EAAE,QAPT;AAQPE,IAAAA,MAAM,EAAE,MARD;AASPC,IAAAA,eAAe,EAAE,SATV;AAUPU,IAAAA,OAAO,EAAE;AAVF;AAhEsB,CAAlB,CAAf","sourcesContent":["import React, { Component } from \"react\";\nimport {\n  StyleSheet,\n  Text,\n  View,\n  TouchableOpacity,\n  Alert,\n  Animated,\n  ActivityIndicator,\n} from \"react-native\";\nimport { Button } from \"native-base\";\nimport * as Font from 'expo-font';\nimport * as firebase from \"firebase\";\nimport { Entypo } from \"@expo/vector-icons\";\nimport { MaterialCommunityIcons } from '@expo/vector-icons'; \n\nimport * as Permissions from \"expo-permissions\";\nimport * as Location from \"expo-location\";\nimport { getDistance } from \"geolib\";\nimport * as Animatable from \"react-native-animatable\";\nimport background from \"../assets/background.png\";\nimport PageTemplate from \"./subComponents/Header\";\nimport { connect } from \"react-redux\";\nimport PlaygroundModal from \"./subComponents/playgroundModal\"\n\n//TRACKING - FAUSTO\nimport { configureBgTasks } from './bg';\nconst TASK_FETCH_LOCATION = 'TASK_FETCH_LOCATION';\n\nconst moment = require(\"moment\");\n\n\n\n\n//let x = 'http://10.244.57.219:3002'\n\n//let x = 'http://192.168.2.5:3002'\nlet x = 'https://volleybuddy.metis-data.site'\n\nclass Home extends Component {\n  \n  uid = firebase.auth().currentUser.uid;\n\n  state = {\n    submitted: false,\n    preSubmitted: false,\n    proximity: null,\n    hasLocationPermission: null,\n    proximityMax: 200,\n    siteLocation: { latitude: null, longitude: null },\n    submittedAnimation: false,\n    animatedValue: new Animated.Value(70),\n     //FAUSTO - USING TLC FOR NOW\n     volleyballCourt: {\n      //latitude: 40.6,\n      //longitude: -73.5\n      latitude: 40.705030,//40.601,//40.7634642,\n      longitude: -74.011550//-73.9290698\n    }\n  };\n\n  async componentDidMount() {\n        await Font.loadAsync({\n      Roboto: require('native-base/Fonts/Roboto.ttf'),\n      Roboto_medium: require('native-base/Fonts/Roboto_medium.ttf'),\n    });\n    //CHECK IS USER IS VERIFIED\n    if (firebase.auth().currentUser.emailVerified == false) {\n      Alert.alert(\n        \"ALERT!\",\n        \"Please verify your email first.\",\n        [{ text: \"OK\" }],\n        { cancelable: false }\n      );\n      this.logout();\n    }\n\n    //READS FROM FIREBASE AND SETS EMAIL AND WORKID IN REDUX\n    this.readFireBase();\n\n    //RETRIEVES SITE INFORMATION (using either email/phone or id)\n    //this.getSiteDataWithEmail(firebase.auth().currentUser.email);\n    \n    //EXECUTES LOCATION PERMISSIONS\n    this.getLocationsPermissions();\n\n\n    //CHECKS IF ALREADY PRECHECKED IN\n    //this.precheckedIn();\n\n    //CHECKS IF ALREADY CHECKED IN\n    this.checkedIn();\n\n    //ADDING GEO TRACKING - FAUSTO\n    const {setEnterRegion} = this.props;\n    configureBgTasks({ setEnterRegion });\n   \n    this.startBackgroundUpdate();\n    this.startGeofence();\n\n\n\n  }\n\n\n//FUNCTION: CHECKS IF ALREADY CHECKED IN TODAY (IN CASE LOGGED OUT)\n\n// precheckedIn = () =>{\n\n//   firebase.database().ref('UsersList/'+ this.uid + '/info').once('value', snapshot => {\n        \n//     let data = snapshot.val()\n\n//     fetch(`https://geohut.metis-data.site/precheckcheck/${data.workId}`)\n//     .then(res => res.json())\n//     .then(res => {  \n     \n//       if (res[\"data\"].some(e => e.checkin_date_time.substr(0,10) === moment().utcOffset(\"-0500\").format(\"YYYY-MM-DD\"))){\n//         this.setState({preSubmitted: true})\n//       }\n//     })\n//     })\n\n// }\n\n//define and start geofence -FAUSTO\nstartGeofence = async () => {\n  console.log('starting geofencing test ...')\n  //let x = \n  Location.startGeofencingAsync('TASK_CHECK_GEOFENCE',\n    [\n    {\n      identifier: 'court',\n      latitude: this.state.volleyballCourt.latitude,\n      longitude: this.state.volleyballCourt.longitude,\n      radius: 150,\n      notifyOnEnter: true,\n      notifyOnExit: true,\n     }\n     ]\n    )\n};\n\n//start tracking in background -FAUSTO\nstartBackgroundUpdate = async () => {\n  Location.startLocationUpdatesAsync(TASK_FETCH_LOCATION, {\n    accuracy: Location.Accuracy.Highest,\n    distanceInterval: 1, // minimum change (in meters) betweens updates\n    deferredUpdatesInterval: 1000, // minimum interval (in milliseconds) between updates\n    // foregroundService is how you get the task to be updated as often as would be if the app was open\n    foregroundService: {\n      notificationTitle: 'Using your location',\n      notificationBody: 'To turn off, go back to the app and switch something off.',\n    },\n  });\n}\n\n\n\ncheckedIn = () =>{\nconsole.log('smth')\n  firebase.database().ref('UsersList/'+ this.uid + '/info').once('value', snapshot => {\n        \n    let data = snapshot.val()\n\n \n\n    fetch(`${x}/checkincheck/${data.email}`)\n    .then(res => res.json())\n    .then(res => {  \n     \n      if (res[\"data\"].some(e => e.checkin_datetime.substr(0,10) === moment().utcOffset(\"-0500\").format(\"YYYY-MM-DD\")) && res[\"data\"].some(e => e.site_id === this.props.reducer.playgroundId)){\n        this.setState({submitted: true})\n        console.log('checkedIN')\n      } else {\n        this.setState({submitted: false})\n      }\n    })\n    .catch((error) => {\n      console.log(error)\n    });\n    })\n\n}\n\n\n  //FUNCTION: READS FIREBASE AND SETS DATA INTO REDUX\n  readFireBase = () => {\n    firebase.database().ref('UsersList/'+ this.uid + '/info').once('value', snapshot => {\n        \n      let data = snapshot.val()\n        //console.log('user data: ',data)\n        this.props.setUserData({\n          firstName: data.firstName,\n          lastName: data.lastName,\n          user_id: data.email\n        });\n      })\n  }\n\n  //***THE TWO FUNCTIONS BELOW ARE OPTIONS FOR US IF WE END UP USING EMAIL/PHONE OR ID */\n\n  //FUNCTION: RETRIEVES SITE DATA FOR THAT USER USING THE EMAIL \n  // getSiteDataWithEmail = (email) => {\n  //   //console.log(\"retrieving site data with email:\", email);\n  //   fetch(`https://geohut.metis-data.site/siteinfo/${email}`)\n  //     .then((res) => res.json())\n  //     .then((res) => {\n        \n  //       //set state\n  //       this.setState({\n  //         siteName: res[\"data\"][0].site_name,\n  //         siteId: res[\"data\"][0].site_id,\n  //         siteAdress: res[\"data\"][0].site_address,\n  //       });\n\n  //       //set lat long in user location\n  //       this.setState((prevState) => ({\n  //         siteLocation: {\n  //           // object that we want to update\n  //           ...prevState.siteLocation, // keep all other key-value pairs\n  //           latitude: res[\"data\"][0].latitude,\n  //           longitude: res[\"data\"][0].longitude, // update the value of specific key\n  //         },\n  //       }));\n\n  //       //set data into reducer\n  //       this.props.setSiteData({\n  //         siteName: res[\"data\"][0].site_name,\n  //         siteId: res[\"data\"][0].site_id,\n  //         siteAdress: res[\"data\"][0].site_address,\n  //         latitude: res[\"data\"][0].latitude,\n  //         longitude: res[\"data\"][0].longitude\n  //       });\n\n  //     });\n  // };\n\n  // //FUNCTION: RETRIEVES SITE DATA FOR THAT USER USING USER_ID \n  // // getSiteDataWithId = (id) => {\n  // //   fetch(`https://geohut.metis-data.site/usersiteinfo/${id}`)\n  // //     .then((res) => res.json())\n  // //     .then((res) => {\n  // //       console.log('user site data: ',res[\"data\"][0]);\n  // //       this.setState({\n  // //         siteName: res[\"data\"][0].site_name,\n  // //         siteId: res[\"data\"][0].site_id,\n  // //         siteAdress: res[\"data\"][0].site_address,\n  // //       });\n\n  // //       this.setState((prevState) => ({\n  // //         siteLocation: {\n  // //           // object that we want to update\n  // //           ...prevState.siteLocation, // keep all other key-value pairs\n  // //           latitude: res[\"data\"][0].latitude,\n  // //           longitude: res[\"data\"][0].longitude, // update the value of specific key\n  // //         },\n  // //       }));\n\n  // //       //set data into reducer\n  // //       this.props.setSiteData({\n  // //         siteName: res[\"data\"][0].site_name,\n  // //         siteId: res[\"data\"][0].site_id,\n  // //         siteAdress: res[\"data\"][0].site_address,\n  // //         latitude: res[\"data\"][0].latitude,\n  // //         longitude: res[\"data\"][0].longitude\n  // //       });\n  // //     });\n  // // };\n\n  //FUNCTION: ASKS FOR LOCATION PERMISSIONS\n  getLocationsPermissions = async () => {\n    let status;\n    status = await Permissions.getAsync(Permissions.LOCATION);\n    if (status.status !== \"granted\") {\n      status = await Permissions.askAsync(Permissions.LOCATION)};\n    if (status.status !== \"granted\") {\n      this.setState({\n        errorMessage: \"Permission to access location was denied\",\n      });\n    } else {\n      this.setState({ hasLocationPermission: status });\n    }\n  };\n\n  //FUNCTION: LOGS OUT\n  logout = () => {\n    firebase\n      .auth()\n      .signOut()\n      .catch((error) => console.log(error));\n\n    this.props.navigation.navigate(\"StartScreen\");\n  };\n\n  //FUNCTION: GETS USER'S CURRENT LOCATION\n  getCurrentLoc = async () => {\n    try {\n      let location = await Location.getCurrentPositionAsync({});\n      location = await JSON.stringify(location);\n      location = await eval(\"(\" + \"[\" + location + \"]\" + \")\");\n      //location && console.log(location[0].coords.latitude);\n      return location;\n    } catch (e) {\n      Alert.alert(\"cannot get current location, try again or ask for help\");\n    }\n  };\n\n  //FUNCTION: CALCULATES DISTANCE INCLUDES TRY CATCH FOR ERRORS\n  calculateDistance = async (start_x,start_y, end_x,end_y) => {\n    try {\n      let distance = await getDistance(\n        {\n          latitude: start_x,\n          longitude: start_y,\n        },\n        {\n          latitude: end_x,\n          longitude: end_y,\n        },\n        (accuracy = 100)\n      );\n      console.log('test')\n      return distance\n      \n    } catch (error) {\n      alert('Something went wrong, please logout, log back in and try again')\n    }\n  }\n\n  //FUNCTION: HANDLES PRECHECKIN\n  // preCheckin = async () => {\n  //   if (this.state.preSubmitted === false) {\n  //     this.setState({ submittedAnimation: true });\n  //     console.log(\"prechecking...\");\n  //     try {\n  //       //get location\n  //       let location = await this.getCurrentLoc();\n  //       console.log(parseFloat(location[0].coords.latitude));\n  //       console.log(parseFloat(location[0].coords.longitude));\n\n  //       //test how far away the user is\n  //       let distance = await this.calculateDistance(\n  //         parseFloat(location[0].coords.latitude),\n  //         parseFloat(location[0].coords.longitude),\n  //         this.state.siteLocation.latitude,\n  //         this.state.siteLocation.longitude\n  //       );\n        \n  //       console.log(\"distance: \", distance);\n  //       console.log(\"worker id: \", this.props.reducer.userInfo.workId)\n  //       //send data\n  //       fetch(\n  //         // MUST USE YOUR LOCALHOST ACTUAL IP!!! NOT http://localhost...\n  //         `https://geohut.metis-data.site/add?time=${\n  //           moment()\n  //             .utcOffset(\"-0500\")\n  //             .format(\"YYYY-MM-DD HH:mm:ss\")\n  //             .substr(0, 18) + \"0\"\n  //         }&site_id=${this.props.reducer.siteData.siteId}&first_name=${this.props.reducer.userInfo.firstName}\n  //             &last_name=${this.props.reducer.userInfo.lastName}&user_id=${this.props.reducer.userInfo.workId}\n  //             &latitude=${parseFloat(location[0].coords.latitude)}\n  //             &longitude=${parseFloat(location[0].coords.longitude)}\n  //             &checkin_type=1\n  //             &distance=${distance}`,\n  //         { method: \"POST\" }\n  //       ).catch((err) => console.error(err));\n\n  //       //show checkin as done\n  //       this.setState({ preSubmitted: true });\n  //       Alert.alert(\"Thank you for pre-checkin, do not forget to checkin!\");\n  //     } catch (e) {\n  //       console.log(e);\n  //     }\n  //     this.setState({ submittedAnimation: false });\n  //   } else {\n  //     Alert.alert(\"You have already done a pre-checkin!\");\n  //   }\n  // };\n\n\n  //FUNCTION: HANDLES MAIN CHECKIN\n  handleButton = async () => {\n\nif (this.props.reducer.playgroundId === ''){\n  Alert.alert(\"Select your playground first.\");\n} else if (this.state.submitted === false) {\n      this.setState({ submittedAnimation: true });\n      try {\n        //get location\n        let location = await this.getCurrentLoc();\n        console.log(parseFloat(location[0].coords.latitude));\n        console.log(parseFloat(location[0].coords.longitude));\n        console.log(this.props.reducer.playgroundLat)\n        console.log(this.props.reducer.playgroundLon)\n        //test how far away the user is\n        let distance = await this.calculateDistance(\n          parseFloat(location[0].coords.latitude),\n          parseFloat(location[0].coords.longitude),\n          this.props.reducer.playgroundLat,\n          this.props.reducer.playgroundLon\n        );\n        console.log(\"distance: \", distance);\n\n        //validate that location is close enough to the site (200 meters)\n        if (distance <= this.state.proximityMax) {\n          //if it is send data to database\n          //this.getCurrentLoc();\n          fetch(\n            // MUST USE YOUR LOCALHOST ACTUAL IP!!! NOT http://localhost...\n            `${x}/add?time=${\n              moment()\n                .utcOffset(\"-0500\")\n                .format(\"YYYY-MM-DD HH:mm:ss\")\n                .substr(0, 18) + \"0\"\n            }&site_id=${this.props.reducer.playgroundId}&first_name=${this.props.reducer.userInfo.firstName}\n            &last_name=${this.props.reducer.userInfo.lastName}&user_id=${this.props.reducer.userInfo.user_id}`,\n            { method: \"POST\" }\n          ).catch((error) => {\n            console.log(error)\n          });\n\n          //close animation\n          //this.handleAnimation();\n\n          //show checkin as done\n\n          this.setState({ submitted: true });\n        } else {\n          //console.log('something went wrong');\n          Alert.alert(\"Please move closer to your site and try again.\");\n        }\n      } catch (e) {\n        console.log(e);\n      }\n      this.setState({ submittedAnimation: false });\n    } else {\nconsole.log(this.props.reducer.playgroundId)\n\nawait fetch(\n  // MUST USE YOUR LOCALHOST ACTUAL IP!!! NOT http://localhost...\n  `${x}/update?site_id=${this.props.reducer.playgroundId}&user_id=${this.props.reducer.userInfo.user_id}`,\n  { method: \"PUT\" }\n).catch((error) => {\n  console.log(error)\n}).then(\n\nawait fetch(\n  // MUST USE YOUR LOCALHOST ACTUAL IP!!! NOT http://localhost...\n  `${x}/addToStorage?site_id=${this.props.reducer.playgroundId}&user_id=${this.props.reducer.userInfo.user_id}`,\n  { method: \"POST\" }\n).catch((error) => {\n  console.log(error)\n})).then(\n  await fetch(\n    // MUST USE YOUR LOCALHOST ACTUAL IP!!! NOT http://localhost...\n    `${x}/delete?site_id=${this.props.reducer.playgroundId}&user_id=${this.props.reducer.userInfo.user_id}`,\n    { method: \"DELETE\" }\n  ).catch((error) => {\n    console.log(error)\n  })\n).then(\n  this.setState({ submitted: false }),\n\n  Alert.alert(\n    \"You left. Good bye.\"\n  )\n)\n\n\n\n\n\n\n      this.setState({ submitted: false });\n\n      Alert.alert(\n        \"You left. Good bye.\"\n      );\n    }\n  };\n\n\n\n  render() {\n\n//console.log(this.state)\n    return (\n      <React.Fragment>\n        <PageTemplate title={\"Home\"} logout={this.logout} />\n        <View style={styles.container}>\n          <View style={styles.bubble}>\n          <TouchableOpacity onPress={() => {\n                  this.props.onModalOne()}}>\n            <MaterialCommunityIcons name=\"target\" size={50} color=\"white\" />\n            </TouchableOpacity>\n          \n          </View>\n\n          <View style={styles.container}>\n            <TouchableOpacity\n              //disabled={this.state.submitted}\n              style={{\n                position: \"absolute\",\n                borderWidth: 1,\n                borderColor: \"rgba(0,0,0,0.2)\",\n                alignItems: \"center\",\n                justifyContent: \"center\",\n                width: 170,\n                height: 170,\n                backgroundColor:\n                  this.state.submitted == false ? \"#eb6e3d\" : \"green\",\n                borderRadius: 100,\n                shadowColor: \"rgba(0,0,0, .4)\", // IOS\n                shadowOffset: { height: 1, width: 1 }, // IOS\n                shadowOpacity: 1, // IOS\n                shadowRadius: 1, //IOS\n                elevation: 15, // Android\n                zIndex: 1,\n              }}\n              onPress={this.handleButton}\n            >\n              {this.state.submitted == false ? (\n                <Entypo name=\"location\" size={60} color=\"white\" />\n              ) : (\n                //<Entypo name=\"check\" size={70} color=\"white\" />\n                <MaterialCommunityIcons name=\"exit-run\" size={60} color=\"white\" />\n              )}\n              {this.state.submitted == false ? (\n              <Text style = {{color:'white', fontSize:15}}>Check In</Text>)\n              : ( <Text style = {{color:'white', fontSize:15}}>Check Out</Text>\n                )}\n            </TouchableOpacity>\n            {/*<ImageBackground source={background} style={styles.image}> </ImageBackground>*/}\n            {this.state.submittedAnimation == false ? (\n              <Animatable.View animation=\"zoomIn\">\n                <Animated.Image\n                  source={background}\n                  resizeMode=\"cover\"\n                  style={{\n                    zIndex: 0,\n                    justifyContent: \"center\",\n                    width: 80,\n                    height: 80,\n                    opacity: 0.2,\n                    transform: [\n                      {\n                        translateX: this.state.animatedValue.interpolate({\n                          inputRange: [0, 80],\n                          outputRange: [0, 1],\n                        }),\n                      },\n                      {\n                        translateY: this.state.animatedValue.interpolate({\n                          inputRange: [0, 80],\n                          outputRange: [0, 1],\n                        }),\n                      },\n                      {\n                        scaleX: this.state.animatedValue.interpolate({\n                          inputRange: [1, 15],\n                          outputRange: [0, 1],\n                        }),\n                      },\n                      {\n                        scaleY: this.state.animatedValue.interpolate({\n                          inputRange: [1, 15],\n                          outputRange: [0, 1],\n                        }),\n                      },\n                    ],\n                  }}\n                />\n              </Animatable.View>\n            ) : (\n              <Animatable.View animation=\"zoomOut\">\n                <Animated.Image\n                  source={background}\n                  resizeMode=\"cover\"\n                  style={{\n                    zIndex: 0,\n                    justifyContent: \"center\",\n                    width: 80,\n                    height: 80,\n                    opacity: 0.2,\n                    transform: [\n                      {\n                        translateX: this.state.animatedValue.interpolate({\n                          inputRange: [0, 80],\n                          outputRange: [0, 1],\n                        }),\n                      },\n                      {\n                        translateY: this.state.animatedValue.interpolate({\n                          inputRange: [0, 80],\n                          outputRange: [0, 1],\n                        }),\n                      },\n                      {\n                        scaleX: this.state.animatedValue.interpolate({\n                          inputRange: [1, 15],\n                          outputRange: [0, 1],\n                        }),\n                      },\n                      {\n                        scaleY: this.state.animatedValue.interpolate({\n                          inputRange: [1, 15],\n                          outputRange: [0, 1],\n                        }),\n                      },\n                    ],\n                  }}\n                />\n              </Animatable.View>\n            )}\n          </View>\n          <View><Text style = {{fontSize: 25,fontStyle: 'italic'}}>{this.props.reducer.playgroundName}</Text></View>\n\n          {/* <Button\n            style={{\n              margin: 10,\n              backgroundColor: \"#ebf2f2\",\n              shadowColor: \"black\", // IOS\n              shadowOffset: { height: 4, width: 0 }, // IOS\n              shadowOpacity: 0.4, // IOS\n              shadowRadius: 1, //IOS\n            }}\n            full\n            rounded\n            onPress={this.preCheckin}\n          >\n            <Text style={{ color: \"black\", fontWeight: \"bold\" }}>\n              Pre-CheckIn\n            </Text>\n          </Button> */}\n\n          {this.state.submittedAnimation && (\n            <View style={styles.loading}>\n              <ActivityIndicator\n                animating={this.state.submittedAnimation}\n                style={{ left: \"0.5%\", bottom: \"40%\" }}\n                size=\"large\"\n                color=\"white\"\n              />\n            </View>\n          )}\n        </View>\n        <PlaygroundModal checkIfChecked = {() => this.checkedIn()}/>\n      </React.Fragment>\n    );\n  }\n}\n\n\n\nconst mapStateToProps = (state) => {\n    \n  const { reducer } = state\n  return { reducer }\n};\n\nconst mapDispachToProps = dispatch => {\n  return {\n    setEmailData: (y) => dispatch({ type: \"SET_EMAIL_DATA\", value: y}),\n    setUserData: (y) => dispatch({ type: \"SET_USER_DATA\", value: y}),\n    setSiteData: (y) => dispatch({ type: \"SET_SITE_DATA\", value: y}),\n    onModalOne: () => dispatch({ type: \"CLOSE_MODAL_1\", value: true})\n  };\n};\n\nexport default connect(mapStateToProps, mapDispachToProps)(Home);\n\n\n\n\n\n\n\n\n\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: \"#fff\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  logout: {\n    ...StyleSheet.absoluteFillObject,\n    alignSelf: \"flex-end\",\n    marginTop: -5,\n    //position: 'absolute', // add if dont work with above\n  },\n  titleText: {\n    fontSize: 15,\n    fontWeight: \"bold\",\n    color: \"white\",\n  },\n  bubble: {\n    position: \"absolute\",\n    top: \"-5%\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    width: \"15%\",\n    height: \"10%\",\n    marginLeft: \"32%\",\n    marginRight: \"32%\",\n    padding: 5,\n    borderRadius: 50,\n    paddingBottom: 5,\n    backgroundColor: \"#4aa0cf\",\n    shadowColor: \"black\", // IOS\n    shadowOffset: { height: 4, width: 0 }, // IOS\n    shadowOpacity: 0.5, // IOS\n    shadowRadius: 1, //IOS\n    elevation: 15, // Android\n    zIndex: 9999,\n  },\n  bubble1: {\n    position: \"absolute\",\n    top: 120,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    width: \"80%\",\n    height: \"4%\",\n    margin: 6,\n    padding: 5,\n    borderRadius: 20,\n    paddingBottom: 5,\n    backgroundColor: \"#4aa0cf\",\n    shadowColor: \"#499ecc\", // IOS\n    shadowOffset: { height: 6, width: 2 }, // IOS\n    shadowOpacity: 1, // IOS\n    shadowRadius: 1, //IOS\n    elevation: 5, // Android\n  },\n  image: {\n    zIndex: 0,\n    justifyContent: \"center\",\n    width: \"100%\",\n    height: \"100%\",\n    opacity: 0.19,\n  },\n\n  loading: {\n    position: \"absolute\",\n    left: 0,\n    right: 0,\n    top: 0,\n    bottom: 0,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    height: \"100%\",\n    backgroundColor: \"#666570\",\n    opacity: 0.8,\n  },\n});\n"]},"metadata":{},"sourceType":"module"}